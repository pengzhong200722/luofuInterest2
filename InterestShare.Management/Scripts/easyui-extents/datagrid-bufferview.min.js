$.extend($.fn.datagrid.defaults,{onBeforeFetch:function(){},onFetch:function(){}});var bufferview=$.extend({},$.fn.datagrid.defaults.view,{render:function(n,t,i){var c=$.data(n,"datagrid"),r=c.options,s=this.rows||[],l,u,f,e;if(s.length&&(l=$(n).datagrid("getColumnFields",i),!i||r.rownumbers||r.frozenColumns&&r.frozenColumns.length)){for(u=parseInt(r.finder.getTr(n,"","last",i?1:2).attr("datagrid-row-index"))+1||0,f=['<table class="datagrid-btable" cellspacing="0" cellpadding="0" border="0"><tbody>'],e=0;e<s.length;e++){var o=r.rowStyler?r.rowStyler.call(n,u,s[e]):"",a="",h="";typeof o=="string"?h=o:o&&(a=o["class"]||"",h=o.style||"");var v='class="datagrid-row '+(u%2&&r.striped?"datagrid-row-alt ":" ")+a+'"',y=h?'style="'+h+'"':"",p=c.rowIdPrefix+"-"+(i?1:2)+"-"+u;f.push('<tr id="'+p+'" datagrid-row-index="'+u+'" '+v+" "+y+">");f.push(this.renderRow.call(this,n,l,i,u,s[e]));f.push("<\/tr>");u++}f.push("<\/tbody><\/table>");$(t).append(f.join(""))}},onBeforeRender:function(n){function e(){i.onLoadSuccess=u.onLoadSuccess;u.onLoadSuccess=function(){};setTimeout(function(){t.body2.unbind(".datagrid").bind("scroll.datagrid",function(){i.onLoadSuccess&&(u.onLoadSuccess=i.onLoadSuccess,i.onLoadSuccess=undefined);r.scrollTimer&&clearTimeout(r.scrollTimer);r.scrollTimer=setTimeout(function(){o.call(r)},50)});t.body2.triggerHandler("scroll.datagrid")},0)}function o(){f()<t.body2.height()&&r.renderedCount<i.data.total?this.getRows.call(this,n,function(i){this.rows=i;this.populate.call(this,n);t.body2.triggerHandler("scroll.datagrid")}):t.body2.scrollTop()>=f()-t.body2.height()&&this.getRows.call(this,n,function(t){this.rows=t;this.populate.call(this,n)})}function f(){var n=0;return t.body2.children("table.datagrid-btable").each(function(){n+=$(this).outerHeight()}),n||(n=r.renderedCount*25),n}var i=$.data(n,"datagrid"),u=i.options,t=i.dc,r=this;this.renderedCount=0;this.rows=[];t.body1.add(t.body2).empty();e()},getRows:function(n,t){var r=$.data(n,"datagrid"),i=r.options,u=Math.floor(this.renderedCount/i.pageSize)+1,o,f,e,s;if(!(this.renderedCount>=r.data.total)&&i.onBeforeFetch.call(n,u)!=!1)if(o=(u-1)*i.pageSize,f=r.data.rows.slice(o,o+i.pageSize),f.length)i.onFetch.call(n,u,f),t.call(this,f);else{if(e=$.extend({},i.queryParams,{page:Math.floor(this.renderedCount/i.pageSize)+1,rows:i.pageSize}),i.sortName&&$.extend(e,{sort:i.sortName,order:i.sortOrder}),i.onBeforeLoad.call(n,e)==!1)return;$(n).datagrid("loading");s=i.loader.call(n,e,function(f){$(n).datagrid("loaded");var f=i.loadFilter.call(n,f);i.onFetch.call(n,u,f.rows);f.rows&&f.rows.length?(r.data.rows=r.data.rows.concat(f.rows),t.call(i.view,f.rows)):i.onLoadSuccess.call(n,f)},function(){$(n).datagrid("loaded");i.onLoadError.apply(n,arguments)});s==!1&&($(n).datagrid("loaded"),r.data.rows.length||(i.onFetch.call(n,u,r.data.rows),i.onLoadSuccess.call(n,r.data)))}},populate:function(n){var t=$.data(n,"datagrid"),r=t.options,i=t.dc;this.rows.length&&(this.renderedCount+=this.rows.length,this.render.call(this,n,i.body2,!1),this.render.call(this,n,i.body1,!0),r.onLoadSuccess.call(n,{total:t.data.total,rows:this.rows}))}});
/*
//# sourceMappingURL=datagrid-bufferview.min.js.map
*/